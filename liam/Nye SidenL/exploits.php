<?php
session_start();

// Function to generate a unique exploit ID
function generateExploitID() {
    return uniqid('exploit_');
}

// Function to add a user to an exploit
function addUserToExploit($username, $exploitID) {
    // Implement your logic to add the user to the exploit
    // For demonstration purposes, let's just print the details
    echo "Added user '$username' to exploit '$exploitID'.<br>";
}

// Check if form is submitted
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    // Handle form submission
    if (isset($_POST['exploit_name'])) {
        $exploitName = $_POST['exploit_name'];
        
        // Check if exploit name already exists in session
        if (!isset($_SESSION['exploits'][$exploitName])) {
            // Generate unique exploit ID
            $exploitID = generateExploitID();
            
            // Store exploit ID in session
            $_SESSION['exploits'][$exploitName] = $exploitID;
            echo "Exploit created successfully with ID: $exploitID<br>";

            // Redirect to another page after a delay
            echo "<script>
                    setTimeout(function() {
                        window.location.href = 'text.php';
                    }, 2000); // 2000 milliseconds = 2 seconds
                  </script>";
        } else {
            echo "Exploit with the same name already exists.<br>";
        }
    } elseif (isset($_POST['username'], $_POST['exploit_id'])) {
        // Add user to exploit
        $username = $_POST['username'];
        $exploitID = $_POST['exploit_id'];
        addUserToExploit($username, $exploitID);
    }
}

// Display existing exploits and users
if (isset($_SESSION['exploits']) && !empty($_SESSION['exploits'])) {
    foreach ($_SESSION['exploits'] as $exploitName => $exploitID) {
        echo "<div class='exploit-item'>";
        echo "<strong>Exploit Name:</strong> $exploitName<br>";
        echo "<strong>Exploit ID:</strong> $exploitID<br>";
        // You can retrieve and display users for each exploit here
        // For demonstration purposes, let's just print a placeholder
        echo "<strong>Users:</strong> User1, User2, User3<br>";
        echo "</div>";
    }
} else {
    echo "No exploits created yet.";
}
?>
